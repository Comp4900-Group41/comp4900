
<!-- saved from url=(0058)file:///home/denis/Desktop/COMP4900/comp4900/index.liquid# -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"></head><body style="cursor: auto;"><header>
 <script src="./index.liquid#_files/jquery.min.js" type="text/javascript"></script>
   <link rel="stylesheet" type="text/css" href="./index.liquid#_files/imgareaselect-default.css">
  <script type="text/javascript" src="./index.liquid#_files/jquery.imgareaselect.pack.js"></script>
  
  <link rel="stylesheet" href="./index.liquid#_files/jquery-ui.css">
<script src="./index.liquid#_files/jquery-ui.min.js"></script>

<link rel="stylesheet" href="./index.liquid#_files/jquery.ui.fontSelector.css">
<script src="./index.liquid#_files/jquery.ui.fontSelector.min.js" type="text/javascript"></script>
  
  <style type="text/css">
  .templateDiv{
    position: relative;
    overflow: hidden;
    padding: 10px;
    width: 600px;
    height:400px;
   
  }
  .dragme{
      position:relative;
      cursor: move;
    }
  .dragDest{
    border: 1px solid #000;
    }
  #draggable {
      background-color: #ccc;
      border: 1px solid #000;
          
    }
  
 #uploadedImage{
  max-width: 500px;
   max-height: 500px;
   min-width: 100px;
   min-height: 100px;
 }
.shirtOverlay { position:relative;

          z-index: 2;
          width: 800px;
          height: auto;
          opacity: 0.8;
   pointer-events: none;
  
        } 

  .clothESpot1wrap{
    padding:0px;
    position:absolute;
    top: 80px;
    left: 100px;
    z-index: 1;;
    width: 100px;
    height: 100px;
  }
    
    .clothESpot2wrap{
      padding:0px;
      position:absolute;
      top: 80px;
      left: 390px;
      z-index: 1;
      width: 100px;
      height: 100px;
  }

      .clothESpot3wrap{
        background-color: blue;
      padding:0px;
      position:absolute;
      top: 200px;
      left: 120px;
      z-index: 1;
      width: 100px;
      height: 100px;
  }
    
    
.clothESpot {          
      width: 100%;
      height: 100%; 
      } 

.resizeGrip {
      width: 20px;
      height: 20px;
      background-color: red;
      border: 1px solid #000000;
      bottom: -10px;
      right:-10px;
}

</style>  
</header>
    <form id="form1" runat="server">
        <input type="file" id="imgInp">
    </form>

<!--<img id="testImage" src="placeholder.png" alt="your image" />-->
<div>
<div>
  <img id="uploadedImage" class="dragme" src="./index.liquid#_files/placeholder.png" alt="your image">
    <canvas id="previewCanvas" draggable="true" class="dragSource"> </canvas>
  <button id="cropButton">enable Crop</button>
</div>

<div>
  <h2> Element Boxes </h2>
<canvas id="ebox1" class="dragDest dragSource" draggable="true" width="200" height="200"> </canvas>
  <canvas id="ebox2" class="dragDest dragSource" draggable="true" width="200" height="200"> </canvas>
  <canvas id="ebox3" class="dragDest dragSource" draggable="true" width="200" height="200"> </canvas>
  
<h1>Example</h1>
<input type="text" id="signature" placeholder="Signature">

    <link rel="stylesheet" type="text/css" href="./index.liquid#_files/css"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(1)"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(2)"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(3)"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(4)"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(5)"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(6)"><link rel="stylesheet" type="text/css" href="./index.liquid#_files/css(7)"><select id="fonts" style="display: none;">
      <option value="" selected="">Default (Droid Serif)</option>
      <option value="Chelsea Market">Chelsea Market</option>
      <option value="Ruluko">Ruluko</option>
      <option value="Ruda">Ruda</option>
      <option value="Magra">Magra</option>
      <option value="Esteban">Esteban</option>
      <option value="Lora">Lora</option>
      <option value="Jura">Jura</option>
    </select><div class="fontSelector ui-widget"><h4 style="font-family: &#39;&#39;" class="selected handle">Default (Droid Serif)</h4><span class="handle">&#9660;</span><ul class="fonts"><li style="font-family: &#39;&#39;" class="selected">Default (Droid Serif)</li><li style="font-family: &#39;Chelsea Market&#39;">Chelsea Market</li><li style="font-family: &#39;Ruluko&#39;">Ruluko</li><li style="font-family: &#39;Ruda&#39;">Ruda</li><li style="font-family: &#39;Magra&#39;">Magra</li><li style="font-family: &#39;Esteban&#39;">Esteban</li><li style="font-family: &#39;Lora&#39;">Lora</li><li style="font-family: &#39;Jura&#39;">Jura</li></ul></div>

    <p>
      <a class="style" id="bold" href="file:///home/denis/Desktop/COMP4900/comp4900/index.liquid#" title="Bold">Bold</a> |
      <a class="style" id="italic" href="file:///home/denis/Desktop/COMP4900/comp4900/index.liquid#" title="Italic">Italic</a> |
      <a class="style" id="underline" href="file:///home/denis/Desktop/COMP4900/comp4900/index.liquid#" title="Underline">Underline</a>
    </p>

</div>



<div class="templateDiv">
  <h2>Template # 1</h2>
  <img src="./index.liquid#_files/tshirtDiagram.png" class="shirtOverlay">
  <div class="draggable resizable clothESpot1wrap ui-resizable ui-draggable ui-draggable-handle">
    <canvas class="clothESpot dragDest multiPaste1"></canvas>
    <div class="ui-resizable-handle ui-resizable-se resizeGrip"></div>
  </div>
   
  <div class="draggable resizable clothESpot2wrap ui-resizable ui-draggable ui-draggable-handle" style="width: 134px; height: 134px;">
     <div class="ui-wrapper" style="overflow: hidden; position: relative; width: 102px; height: 102px; top: auto; left: auto; margin: 0px;"><canvas class="clothESpot dragDest multiPaste2 resizable ui-resizable" style="margin: 0px; resize: none; position: static; zoom: 1; display: block; height: 100px; width: 100px;"></canvas></div>
      <div class="ui-resizable-handle ui-resizable-se resizeGrip"></div>
  </div>

   <div class="draggable resizable clothESpot3wrap ui-resizable ui-draggable ui-draggable-handle">
    <div class="ui-wrapper" style="overflow: hidden; position: relative; width: 102px; height: 102px; top: auto; left: auto; margin: 0px;"><canvas class="clothESpot dragDest multiPaste2 resizable ui-resizable" style="margin: 0px; resize: none; position: static; zoom: 1; display: block; height: 100px; width: 100px;"></canvas></div>
    <div class="ui-resizable-handle ui-resizable-se resizeGrip"></div>
  </div>

</div>
  
<div class="templateDiv">
  <h2>Template # 2</h2>
  <img src="./index.liquid#_files/tshirtDiagram.png" class="shirtOverlay">
  <div class="draggable resizable clothESpot1wrap ui-resizable ui-draggable ui-draggable-handle">
    <div class="ui-wrapper" style="overflow: hidden; position: relative; width: 102px; height: 102px; top: auto; left: auto; margin: 0px;"><canvas class="clothESpot dragDest multiPaste1 resizable ui-resizable" width="100" height="100" style="margin: 0px; resize: none; position: static; zoom: 1; display: block; height: 100px; width: 100px;"></canvas></div>
     <div class="ui-resizable-handle ui-resizable-se" id="resizeGrip"></div>
  </div>
   
  <div class="draggable resizable clothESpot2wrap ui-resizable ui-draggable ui-draggable-handle">
     <div class="ui-wrapper" style="overflow: hidden; position: relative; width: 102px; height: 102px; top: auto; left: auto; margin: 0px;"><canvas class="clothESpot dragDest multiPaste2 resizable ui-resizable" width="100" height="100" style="margin: 0px; resize: none; position: static; zoom: 1; display: block; height: 100px; width: 100px;"></canvas></div>
      <div class="ui-resizable-handle ui-resizable-se" id="resizeGrip"></div>
  </div>

</div>
</div>




<script type="text/javascript">
  var startOffsetX;
  var startOffsetY;
  var draggedElement;
  var uploadedImageScale;
  
 $(document).ready(function () {
//area selection (for cropping)
   var originalWidth = $('#uploadedImage').width;
   var originalHeight = $('#uploadedImage').height;
   var ias = $('#uploadedImage').imgAreaSelect({onSelectChange: preview, instance: true});

  
  $(".dragSource").each(function() {
        this.onmousedown = mousedown;
        this.ondragstart = dragstart;
    });
  
  $(".dragDest").each(function() {
      this.ondrop = drop;
      this.ondragover = allowDrop;
    });
   
    $('#cropButton').click(function() {
      ias.setOptions({ disable: true, hide: true });
    ias.update();
    });
  
  $(".resizable").each(function() { 
    var handle = $(this).find('.resizeGrip');

    $(this).resizable({
    aspectRatio: true,
      handles: {
        'se': handle}
    });
  });

   //makes element draggable in the template div
    $( ".draggable" ).draggable();
   $(".templateDiv").mouseout(function() {
    $( '.draggable' ).draggable().trigger( 'mouseup' );
});


  
//draw selection on a canvas
function preview(img, selection) {
  var canvas = $('#previewCanvas')[0];
  var selectionSource = $('#uploadedImage')[0];
  var ctx = canvas.getContext("2d");  
  var maxSize = 100;
  var destX = 0;
  var destY = 0;
  var longestSide = Math.max(selection.width, selection.height);
  var scale = maxSize / longestSide;
  canvas.width =  selection.width * scale;
  canvas.height =  selection.height * scale;
  
  ctx.drawImage(img,
                selection.x1 * (img.naturalHeight / img.height),
                selection.y1 * (img.naturalHeight / img.height),
                selection.width * (img.naturalHeight / img.height),
                selection.height * (img.naturalHeight / img.height),
                destX,
                destY, 
                selection.width * scale,
                selection.height * scale
               );                       
}

// this is the mouse position within the drag element
var startOffsetX, startOffsetY;

//textBox stuff
       $('select#fonts').fontSelector({
          fontChange: function(e, ui) {
            // Update signature according to the font that's set in the widget options:
            $('#signature').css({
              fontFamily: ui.font,
            });
          },
          styleChange: function(e, ui) {
            // signature according to what's set in the widget options:
            if(ui.value == true) {
              if(ui.style == 'bold') $('#signature').css({fontWeight: 'bold'});
              if(ui.style == 'italic') $('#signature').css({fontStyle: 'italic'});
              if(ui.style == 'underline') $('#signature').css({textDecoration: 'underline'});
            } else {
              if(ui.style == 'bold') $('#signature').css({fontWeight: 'normal'});
              if(ui.style == 'italic') $('#signature').css({fontStyle: 'normal'});
              if(ui.style == 'underline') $('#signature').css({textDecoration: 'none'});
            }
          }
        });

        $('p a.style').click(function(){
          var style = $(this).attr('id'); // This will be bold, italic or underline.
          var current = $('select#fonts').fontSelector('option', style);
          var setTo = true;
          if(current == true) setTo = false;
          $('select#fonts').fontSelector('option', style, setTo);
          return false;
        });
});
  
  //uploading image function
   function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function (e) {
                $('#uploadedImage').attr('src', e.target.result);
            }           
            reader.readAsDataURL(input.files[0]);          
        }
    }
    
    $("#imgInp").change(function(){
        readURL(this);
    });


function allowDrop(ev) {
    ev.preventDefault();
}


function mousedown(ev) {
    startOffsetX = ev.offsetX;
    startOffsetY = ev.offsetY;
}

function dragstart(ev) {
    ev.dataTransfer.setData("Text", ev.target.id);
    draggedElement = ev.target;
}

function drop(ev) {
  ev.preventDefault();
  
 var canvas = ev.target;
 var canvasId = $(canvas).id;
 drawCopiedImage(canvas, ev); 
  //loops through multipaste elements and draws image on all of them
  var multiPasteClasses = ["multiPaste1", "multiPaste2"];
  for (var i = 0; i < multiPasteClasses.length; i++) {
   
    if($(canvas).hasClass(multiPasteClasses[i])){
      $("." + multiPasteClasses[i]).each(function() {
      drawCopiedImage(this, ev);
    });
    }
  
  }
    
  
}
  //draws copied image on the canvas
  function drawCopiedImage(canvas, ev){
   var ctx = canvas.getContext("2d");
/*
  var leftOffset = ev.pageX - this.offsetLeft 
  var topOffset = ev.pageY - this.offsetTop
  var dropX = leftOffset - startOffsetX;
  var dropY = topOffset - startOffsetY
  var id = ev.dataTransfer.getData("Text");
  */
    ctx.drawImage(draggedElement, 0, 0, canvas.width, canvas.height);
    //drop anywhere
   // ctx.drawImage(dropElement, dropX, dropY);
  }
  
  /*
  //creates a new canvas at target location and drops selected image into it
  function freeDrop(ev){
    ev.preventDefault();
    
    var canvas = document.createElement('canvas');
  var element = document.getElementById("freeDropZone");
  element.appendChild(canvas);
    
    //var canvas = document.getElementById("c1")
    
var ctx = canvas.getContext("2d");
var dropElement = document.getElementById("previewCanvas");
ctx.drawImage(dropElement, 0, 0);
    
    
  }
  */  
  
 
</script>

<div style="position: absolute; overflow: hidden; z-index: 2;"><div class="imgareaselect-selection" style="position: absolute; font-size: 0px;"></div><div class="imgareaselect-border1" style="position: absolute; font-size: 0px;"></div><div class="imgareaselect-border2" style="position: absolute; font-size: 0px;"></div><div class="imgareaselect-border3" style="position: absolute; font-size: 0px;"></div><div class="imgareaselect-border4" style="position: absolute; font-size: 0px;"></div></div><div class="imgareaselect-outer" style="position: absolute; overflow: hidden; z-index: 0;"></div><div class="imgareaselect-outer" style="position: absolute; overflow: hidden; z-index: 0;"></div><div class="imgareaselect-outer" style="position: absolute; overflow: hidden; z-index: 0;"></div><div class="imgareaselect-outer" style="position: absolute; overflow: hidden; z-index: 0;"></div></body></html>